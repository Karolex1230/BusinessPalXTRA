<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Visual Website Builder | BusinessPal</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui,Arial;
  background:#0a0a0a;
  color:#fff;
  display:flex;
  height:100vh;
  overflow:hidden;
}

/* Sidebar */
.sidebar{
  width:280px;
  background:#000;
  border-right:1px solid #222;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:10px;
  z-index:10;
}

.sidebar button,
.sidebar input[type="color"]{
  padding:14px;
  border-radius:12px;
  border:none;
  background:#1f2933;
  color:#fff;
  font-weight:700;
}

.sidebar button:active{background:#3b82f6}

/* Mobile sidebar */
@media(max-width:900px){
  body{flex-direction:column}
  .sidebar{
    width:100%;
    flex-direction:row;
    overflow-x:auto;
    border-right:none;
    border-bottom:1px solid #222;
  }
  .sidebar h2,
  .sidebar small,
  .back-home{display:none}
}

/* Canvas */
.canvas{
  flex:1;
  background:#e5e7eb;
  overflow:auto;
}

.site{
  max-width:1200px;
  margin:20px auto;
  background:#fff;
  min-height:100vh;
}

/* Sections */
.section{
  padding:60px 30px;
  border:2px dashed transparent;
  position:relative;
}

.section.selected{
  border-color:#3b82f6;
}

.hero{
  background:#3b82f6;
  color:#fff;
  text-align:center;
}

.text-section{color:#000}

/* Floating toolbar */
.toolbar{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#000;
  border-radius:14px;
  padding:10px;
  display:none;
  gap:8px;
  z-index:20;
}

.toolbar button{
  padding:10px 14px;
  border:none;
  border-radius:10px;
  background:#1f2933;
  color:#fff;
  font-weight:700;
}
</style>

</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <h2>Website Builder</h2>

  <button onclick="addHero()">Add Hero</button>
  <button onclick="addText()">Add Text</button>
  <button onclick="addImage()">Add Image</button>

  <label style="margin-top:10px">Background colour</label>
  <input type="color" onchange="changeBackground(this.value)">

  <small>
  Build your website visually.<br>
  You can save your progress and send it to BusinessPal for professional completion.
  <br><br>
  <strong>Please note:</strong> This website builder is currently in an active testing and rebuild phase.
  Some features may be incomplete or behave unexpectedly as we continue improving the experience.
  
  <strong>CURRENTLY NOT WORKING ON MOBILE</strong>
</small>


  <button class="back-home" onclick="location.href='index.html'">
    ‚Üê Back to Home
  </button>

  <input type="file" id="imageUpload" accept="image/*" hidden onchange="handleImage(event)">
</div>

<!-- CANVAS -->
<div class="canvas">
  <div id="site" class="site"></div>
</div>

<!-- ACTION BAR -->
<div class="bottom-bar">
  <button class="save" onclick="saveSite()">Save</button>
  <button class="export" onclick="exportHTML()">Download</button>
</div>

<script>
const site = document.getElementById('site');
let selected = null;
let dragEl = null;
let startY = 0;

/* Section creator */
function makeSection(html){
  const div = document.createElement('div');
  div.className = 'section';
  div.innerHTML = html;
  enableSection(div);
  site.appendChild(div);
}

/* Enable selection + touch drag */
function enableSection(el){
  el.addEventListener('pointerdown', e=>{
    select(el);
    dragEl = el;
    startY = e.clientY;
    el.setPointerCapture(e.pointerId);
  });

  el.addEventListener('pointermove', e=>{
    if(!dragEl) return;
    const dy = e.clientY - startY;
    const target = document.elementFromPoint(e.clientX, e.clientY);
    if(target && target.closest('.section') && target !== dragEl){
      site.insertBefore(dragEl, dy > 0 ? target.nextSibling : target);
    }
  });

  el.addEventListener('pointerup', ()=> dragEl = null);
}

/* Selection */
function select(el){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('selected'));
  selected = el;
  el.classList.add('selected');
  toolbar.style.display = 'flex';
}

/* Sections */
function addHero(){
  makeSection(`
    <div class="hero">
      <h1 contenteditable>Your Website Title</h1>
      <p contenteditable>Describe your business</p>
    </div>
  `);
}

function addText(){
  makeSection(`
    <div class="text-section">
      <p contenteditable>Click to edit text</p>
    </div>
  `);
}

function addImage(){
  document.getElementById('imageUpload').click();
}

function handleImage(e){
  const file = e.target.files[0];
  const r = new FileReader();
  r.onload = ()=>makeSection(`<img src="${r.result}" style="max-width:100%">`);
  r.readAsDataURL(file);
}

/* Toolbar actions */
function removeSection(){
  if(selected){selected.remove(); toolbar.style.display='none';}
}

function duplicateSection(){
  if(!selected) return;
  const clone = selected.cloneNode(true);
  enableSection(clone);
  site.insertBefore(clone, selected.nextSibling);
}

function bgColor(color){
  if(selected) selected.style.background = color;
}

/* Save & Load */
function saveSite(){
  localStorage.setItem('savedSite', site.innerHTML);
  alert('Saved');
}

window.onload=()=>{
  const saved=localStorage.getItem('savedSite');
  if(saved){
    site.innerHTML=saved;
    document.querySelectorAll('.section').forEach(enableSection);
  }
}

/* Export */
function exportHTML(){
  const clean = site.cloneNode(true);
  clean.querySelectorAll('.section').forEach(s=>s.classList.remove('selected'));
  const html=`<!doctype html><html><head><meta name="viewport" content="width=device-width"><style>body{margin:0;font-family:Arial}.section{padding:60px}</style></head><body>${clean.innerHTML}</body></html>`;
  const blob=new Blob([html],{type:'text/html'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='site.html';
  a.click();
}
</script>

<div class="toolbar" id="toolbar">
  <button onclick="duplicateSection()">Duplicate</button>
  <button onclick="removeSection()">Delete</button>
  <input type="color" onchange="bgColor(this.value)">
</div>

</body>
</html>


